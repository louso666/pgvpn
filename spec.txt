üìÑ –°—Ö–µ–º–∞ —Ç—É–Ω–Ω–µ–ª–µ–π –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (–∏—é–Ω—å 2025)

1. –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   ‚îú‚îÄ pg.gena.host   (–†–æ—Å—Å–∏—è, –æ—Å–Ω–æ–≤–Ω–æ–π DNS + —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)
   ‚îÇ    ‚Ä¢ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å WireGuard wg200 ‚Üí 10.200.0.1/24
   ‚îÇ    ‚Ä¢ dnsproxy (10.200.0.1:53) + Telegram-–±–æ—Ç
   ‚îÇ    ‚Ä¢ NAT 10.200.0.0/24 ‚Üí eth0 (SNAT/MASQ)
   ‚îÇ    ‚Ä¢ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ ipset ¬´proxied¬ª (MARK 0x42)
   ‚îÇ    ‚Ä¢ IPTables –∫–æ–Ω—Ñ–∏–≥: /etc/iptables/rules.v4|v6 (+ ipsets)
   ‚îÇ    ‚Ä¢ –°–ª—É–∂–µ–±–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã: /etc/scripts/*.sh
   ‚îú‚îÄ p.nirhub.ru    (–ì–µ—Ä–º–∞–Ω–∏—è, GRE-relay + –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—à–ª—é–∑)
   ‚îÇ    ‚Ä¢ WireGuard wg200 ‚Üí 10.200.0.6/24
   ‚îÇ    ‚Ä¢ GRE gre-p2p –æ—Ç 159.69.33.152 ‚áÑ pg.gena.host (176.114.88.142)
   ‚îÇ    ‚Ä¢ MASQUERADE –¥–ª—è –ø–æ–¥–ø—Å–µ—Ç–µ–π 10.200.0.0/24, 10.8.0.0/24, 10.168.0.0/14 etc.
   ‚îÇ    ‚Ä¢ UFW –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—à–∏—Ä–Ω—ã–π filter-table ‚Üí rules.v4
   ‚îÇ    ‚Ä¢ IPTables –∫–æ–Ω—Ñ–∏–≥ –ª–µ–∂–∏—Ç –≤ /etc/iptables/rules.v4|v6
   ‚îî‚îÄ pg2.gena.host  (–¥–æ–ø. —É–∑–µ–ª, peer ‚Üí 10.200.0.20/24)
        ‚Ä¢ WireGuard peer –∫ pg.gena.host, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ NAT
        ‚Ä¢ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã –ø–æ–∑–∂–µ –±—É–¥—É—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ (–ø–æ–∫–∞ –∫–æ–Ω—Ñ–∏–≥ –ø—É—Å—Ç–æ–π)

2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–ò–°–ö–õ–Æ–ß–ê–ï–ú –∏–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
   ‚Ä¢ /root/site                 ‚Äì —Å–ø–∏—Å–æ–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –º–µ–Ω—è–µ—Ç—Å—è –±–æ—Ç–æ–º
   ‚Ä¢ /root/map.json             ‚Äì –∏—Å—Ç–æ—Ä–∏—è DNS-‚ÜíIP, –∑–∞–ø–æ–ª–Ω—è–µ—Ç dnsproxy
   ‚Ä¢ /etc/wireguard/*           ‚Äì –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º /root/wg
   ‚Ä¢ /etc/ipset.conf            ‚Äì ¬´ipset save¬ª, –º–µ–Ω—è–µ—Ç—Å—è –≤ —Ä–∞–Ω—Ç–∞–π–º–µ

3. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–°–ò–ù–•–†–û–ù–ò–ó–ò–†–£–ï–ú)
   ‚Ä¢ /etc/iptables/**           ‚Äì rules.v4 / rules.v6
   ‚Ä¢ /etc/systemd/system/*.service (proxy-route, gre-p2p, gre-keepalive –∏ —Ç.–¥.)
   ‚Ä¢ –õ—é–±—ã–µ *.conf, *.sh —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å GRE/wireguard, –∫—Ä–æ–º–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö

4. Watchdog'–∏ / –∞–≤—Ç–æ–ø–æ–¥—ä—ë–º
   ‚Ä¢ wg-quick@wg200.service ‚Äì –±–∞–∑–æ–≤—ã–π –ø–æ–¥—ä—ë–º WG
   ‚Ä¢ gre-p2p.service + gre-keepalive.timer ‚Äì —Å–æ–∑–¥–∞—é—Ç GRE-—Ç—É–Ω–Ω–µ–ª—å –∏ –¥–µ—Ä–∂–∞—Ç –µ–≥–æ –∂–∏–≤—ã–º
   ‚Ä¢ iptables/ipset –º–µ—Ç–∫–∏ (MARK 0x42) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç —Ç—Ä–∞—Ñ–∏–∫ ¬´–ø—Ä–æ–∫—Å–∏—Ä—É–µ–º—ã—Ö¬ª IP —á–µ—Ä–µ–∑ GRE
   ‚Ä¢ UFW –Ω–∞ p.nirhub.ru —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –±–æ–ª—å—à–æ–π filter-table; iptables-save –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–∞—à–∏ —Å–∫—Ä–∏–ø—Ç—ã

5. –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è
   1) pull-configs.sh ‚Äì rsync c —Å–µ—Ä–≤–µ—Ä–æ–≤ ‚Üí ./<host>/‚Ä¶
      ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ssh (root) + –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç 32322 –¥–ª—è p.nirhub.ru
      ‚Ä¢ --exclude –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏, --archive –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∞–≤
   2) –í–Ω–µ—Å–µ–Ω–∏–µ –ø—Ä–∞–≤–æ–∫ –ª–æ–∫–∞–ª—å–Ω–æ (git-–∫–æ–Ω—Ç—Ä–æ–ª—å)
   3) push-configs.sh ‚Äì rsync ./<host>/‚Ä¶ ‚Üí —Å–µ—Ä–≤–µ—Ä
      ‚Ä¢ –ë–µ–∑ --delete, —á—Ç–æ–±—ã –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã
      ‚Ä¢ –ü–æ—Å–ª–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
        ‚ñ∏ iptables-restore < rules.v4|v6
        ‚ñ∏ systemctl daemon-reload && systemctl restart <modified-units>
      ‚Ä¢ –°–∫—Ä–∏–ø—Ç –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äì –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–¥–º–∏–Ω –≤—Ä—É—á–Ω—É—é

6. –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
   ‚Ä¢ scripts/pull-configs.sh    ‚Äì rsync ‚Üí –ª–æ–∫–∞–ª—å–Ω–æ; —Ä–µ–∂–µ—Ç *.backup/*.applied –∏ –ø—Ä.
   ‚Ä¢ scripts/push-configs.sh    ‚Äì rsync ‚Üê –Ω–∞ —Å–µ—Ä–≤–µ—Ä; –æ–±—â–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥–æ–≤
   ‚Ä¢ scripts/servers.conf       ‚Äì —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤/–ø–æ—Ä—Ç–æ–≤ 